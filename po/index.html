<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="堅心報價採購">
<meta name="theme-color" content="#2F2F2F">
<meta name="mobile-web-app-capable" content="yes">
<title>堅心報價/採購 — Outrun Nutrition</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
/* ==================== 基礎設定 ==================== */
:root {
  --black: #2F2F2F;
  --orange: #ED5D2B;
  --orange-hover: #d14e1f;
  --blue: #145DDD;
  --dark-gray: #3A3A3A;
  --card-gray: #444444;
  --text-primary: #E0E0E0;
  --text-secondary: #A0A0A0;
  --text-dim: #707070;
  --danger: #E53935;
  --success: #43A047;
  --warning: #FB8C00;
  --radius-lg: 12px;
  --radius-sm: 6px;
  --radius-xs: 4px;
  --font-zh: 'Noto Sans TC', sans-serif;
  --font-en: 'Montserrat', sans-serif;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
html { font-size: 16px; }
body {
  font-family: var(--font-zh);
  background: var(--black);
  color: var(--text-primary);
  line-height: 1.6;
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

/* ==================== 頂部導覽 ==================== */
.top-bar {
  background: var(--dark-gray);
  padding: 12px 20px;
  display: flex;
  align-items: center;
  justify-content: space-between;
  position: sticky;
  top: 0;
  z-index: 100;
  border-bottom: 1px solid rgba(237, 93, 43, 0.3);
}
.brand { display: flex; align-items: center; gap: 10px; }
.brand-icon {
  width: 32px; height: 32px;
  background: var(--orange);
  border-radius: 50%;
  display: flex; align-items: center; justify-content: center;
  font-size: 16px;
}
.brand-name {
  font-family: var(--font-en);
  font-weight: 700; font-size: 14px;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  color: var(--orange);
}
.brand-sub { font-size: 11px; color: var(--text-secondary); }
.sync-status {
  display: flex; align-items: center; gap: 6px;
  font-size: 12px; color: var(--text-secondary);
}
.sync-dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: var(--success);
}
.sync-dot.offline { background: var(--warning); }

/* ==================== 分頁導覽 ==================== */
.tab-nav {
  display: flex;
  background: var(--dark-gray);
  border-bottom: 1px solid rgba(255,255,255,0.05);
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}
.tab-btn {
  flex: 1; min-width: 70px;
  padding: 10px 6px;
  background: none; border: none;
  color: var(--text-secondary);
  font-family: var(--font-zh);
  font-size: 12px; font-weight: 500;
  cursor: pointer; text-align: center;
  border-bottom: 2px solid transparent;
  transition: all 0.2s;
  white-space: nowrap;
}
.tab-btn.active { color: var(--orange); border-bottom-color: var(--orange); }
.tab-btn:hover { color: var(--text-primary); }
.tab-icon { font-size: 16px; display: block; margin-bottom: 2px; }

/* ==================== 主內容區 ==================== */
.main-content { max-width: 640px; margin: 0 auto; padding: 16px; }
.tab-panel { display: none; }
.tab-panel.active { display: block; }

/* ==================== 卡片元件 ==================== */
.card {
  background: var(--dark-gray);
  border-radius: var(--radius-lg);
  padding: 20px; margin-bottom: 16px;
}
.card-header {
  display: flex; align-items: center;
  justify-content: space-between; margin-bottom: 16px;
}
.card-title { font-size: 15px; font-weight: 700; color: var(--text-primary); }
.card-badge {
  font-family: var(--font-en);
  font-size: 11px; font-weight: 600;
  text-transform: uppercase; letter-spacing: 0.08em;
  padding: 3px 8px; border-radius: var(--radius-xs);
  background: rgba(237, 93, 43, 0.15); color: var(--orange);
}

/* ==================== 表單元件 ==================== */
.form-group { margin-bottom: 16px; }
.form-label {
  display: block; font-size: 13px; font-weight: 500;
  color: var(--text-secondary); margin-bottom: 6px;
}
.form-label .required { color: var(--orange); margin-left: 2px; }
.form-input, .form-select, .form-textarea {
  width: 100%; padding: 10px 12px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-family: var(--font-zh); font-size: 15px;
  transition: border-color 0.2s;
  -webkit-appearance: none;
}
.form-input:focus, .form-select:focus, .form-textarea:focus {
  outline: none; border-color: var(--orange);
  background: rgba(237, 93, 43, 0.05);
}
.form-input::placeholder { color: var(--text-dim); }
.form-select {
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%23A0A0A0' stroke-width='2'%3E%3Cpolyline points='6 9 12 15 18 9'%3E%3C/polyline%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 12px center;
  padding-right: 36px;
  color-scheme: dark;
}
.form-select option { background: var(--dark-gray); color: var(--text-primary); }
.form-textarea { resize: vertical; min-height: 60px; }
.form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
.form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 12px; }

/* ==================== 按鈕 ==================== */
.btn {
  display: inline-flex; align-items: center; justify-content: center;
  gap: 6px; padding: 12px 24px; border: none;
  border-radius: var(--radius-sm);
  font-family: var(--font-zh); font-size: 14px; font-weight: 600;
  cursor: pointer; transition: all 0.2s; text-decoration: none;
}
.btn-primary {
  background: var(--orange); color: #fff;
  width: 100%; padding: 14px; font-size: 16px;
}
.btn-primary:hover { background: var(--orange-hover); }
.btn-primary:disabled { opacity: 0.5; cursor: not-allowed; }
.btn-secondary { background: rgba(255,255,255,0.08); color: var(--text-primary); }
.btn-secondary:hover { background: rgba(255,255,255,0.12); }
.btn-outline {
  background: transparent;
  border: 1px solid rgba(255,255,255,0.15);
  color: var(--text-primary);
}
.btn-outline:hover { border-color: var(--orange); color: var(--orange); }
.btn-danger { background: rgba(229, 57, 53, 0.15); color: var(--danger); }
.btn-danger:hover { background: rgba(229, 57, 53, 0.25); }
.btn-sm { padding: 6px 12px; font-size: 12px; }
.btn-group { display: flex; gap: 8px; margin-top: 16px; }

/* ==================== 明細行表格 ==================== */
.line-items { margin-bottom: 16px; }
.line-item {
  background: rgba(255,255,255,0.03);
  border: 1px solid rgba(255,255,255,0.06);
  border-radius: var(--radius-sm);
  padding: 12px; margin-bottom: 8px;
  position: relative;
}
.line-item-header {
  display: flex; justify-content: space-between;
  align-items: center; margin-bottom: 8px;
}
.line-item-num {
  font-family: var(--font-en); font-size: 11px;
  font-weight: 600; color: var(--orange);
}
.line-item-remove {
  width: 24px; height: 24px; border: none;
  background: rgba(229, 57, 53, 0.1);
  border-radius: 50%; color: var(--danger);
  font-size: 14px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
  transition: all 0.15s;
}
.line-item-remove:hover { background: rgba(229, 57, 53, 0.25); }
.line-item .form-group { margin-bottom: 8px; }
.line-item .form-label { font-size: 11px; margin-bottom: 4px; }
.line-item .form-input, .line-item .form-select {
  padding: 8px 10px; font-size: 13px;
}
.line-item-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; }
.line-item-subtotal {
  text-align: right; font-family: var(--font-en);
  font-size: 14px; font-weight: 600; color: var(--orange);
  padding-top: 4px;
}
.add-line-btn {
  width: 100%; padding: 10px; border: 2px dashed rgba(255,255,255,0.12);
  border-radius: var(--radius-sm); background: none;
  color: var(--text-secondary); font-family: var(--font-zh);
  font-size: 13px; cursor: pointer; transition: all 0.2s;
}
.add-line-btn:hover {
  border-color: var(--orange); color: var(--orange);
  background: rgba(237, 93, 43, 0.05);
}

/* ==================== 金額匯總 ==================== */
.amount-summary {
  border-top: 1px solid rgba(255,255,255,0.08);
  padding-top: 12px; margin-top: 8px;
}
.amount-row {
  display: flex; justify-content: space-between;
  align-items: center; padding: 6px 0;
  font-size: 14px;
}
.amount-row .label { color: var(--text-secondary); }
.amount-row .value {
  font-family: var(--font-en); font-weight: 600;
}
.amount-row.total {
  border-top: 2px solid var(--orange);
  padding-top: 10px; margin-top: 6px;
  font-size: 18px;
}
.amount-row.total .label { color: var(--text-primary); font-weight: 700; }
.amount-row.total .value { color: var(--orange); font-weight: 700; }
.amount-row.discount .value { color: var(--success); }

/* ==================== 列表卡片 ==================== */
.doc-card {
  background: var(--dark-gray);
  border-radius: var(--radius-lg);
  padding: 16px; margin-bottom: 10px;
  cursor: pointer; transition: all 0.2s;
  border: 1px solid transparent;
}
.doc-card:hover { border-color: rgba(237, 93, 43, 0.3); }
.doc-card-top {
  display: flex; justify-content: space-between;
  align-items: flex-start; margin-bottom: 8px;
}
.doc-card-id {
  font-family: var(--font-en); font-size: 13px;
  font-weight: 600; color: var(--text-primary);
}
.doc-card-date { font-size: 12px; color: var(--text-dim); }
.doc-card-mid {
  display: flex; justify-content: space-between;
  align-items: center;
}
.doc-card-name { font-size: 14px; font-weight: 500; }
.doc-card-amount {
  font-family: var(--font-en); font-size: 16px;
  font-weight: 700; color: var(--orange);
}
.doc-card-bottom {
  display: flex; justify-content: space-between;
  align-items: center; margin-top: 8px;
}
.doc-card-recorder { font-size: 11px; color: var(--text-dim); }

/* ==================== 狀態標籤 ==================== */
.status-tag {
  display: inline-block; padding: 2px 8px;
  border-radius: var(--radius-xs);
  font-size: 11px; font-weight: 600;
}
.status-draft { background: rgba(160,160,160,0.15); color: var(--text-secondary); }
.status-sent { background: rgba(20,93,221,0.15); color: var(--blue); }
.status-accepted { background: rgba(67,160,71,0.15); color: var(--success); }
.status-rejected { background: rgba(229,57,53,0.15); color: var(--danger); }
.status-pending { background: rgba(251,140,0,0.15); color: var(--warning); }
.status-confirmed { background: rgba(20,93,221,0.15); color: var(--blue); }
.status-delivered { background: rgba(67,160,71,0.15); color: var(--success); }
.status-invoiced { background: rgba(237,93,43,0.15); color: var(--orange); }
.status-paid { background: rgba(67,160,71,0.25); color: var(--success); }

/* ==================== 搜尋列 ==================== */
.search-bar {
  display: flex; gap: 8px; margin-bottom: 12px; flex-wrap: wrap;
}
.search-bar input {
  flex: 1; min-width: 120px; padding: 8px 12px;
  background: var(--dark-gray);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-family: var(--font-zh); font-size: 13px;
}
.search-bar input:focus { outline: none; border-color: var(--orange); }
.search-bar input::placeholder { color: var(--text-dim); }
.search-bar select {
  padding: 8px 10px;
  background: var(--dark-gray);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius-sm);
  color: var(--text-primary);
  font-family: var(--font-zh); font-size: 13px;
  color-scheme: dark;
}

/* ==================== 月份選擇器 ==================== */
.month-nav {
  display: flex; align-items: center;
  justify-content: center; gap: 16px;
  margin-bottom: 16px;
}
.month-nav button {
  width: 36px; height: 36px;
  background: rgba(255,255,255,0.06);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: 50%; color: var(--text-primary);
  font-size: 16px; cursor: pointer;
  display: flex; align-items: center; justify-content: center;
}
.month-nav button:hover { border-color: var(--orange); color: var(--orange); }
.month-nav .month-label {
  font-family: var(--font-en); font-size: 16px;
  font-weight: 600; min-width: 120px; text-align: center;
}

/* ==================== 統計卡片 ==================== */
.stats-grid {
  display: grid; grid-template-columns: 1fr 1fr;
  gap: 10px; margin-bottom: 16px;
}
.stat-card {
  background: var(--dark-gray);
  border-radius: var(--radius-lg);
  padding: 16px; text-align: center;
}
.stat-label { font-size: 12px; color: var(--text-secondary); margin-bottom: 4px; }
.stat-value {
  font-family: var(--font-en); font-size: 22px;
  font-weight: 700; color: var(--text-primary);
}
.stat-value.orange { color: var(--orange); }

/* ==================== 趨勢圖 ==================== */
.trend-chart {
  display: flex; align-items: flex-end;
  gap: 4px; height: 120px; padding: 8px 0;
}
.trend-bar-wrap {
  flex: 1; display: flex; flex-direction: column;
  align-items: center; height: 100%;
}
.trend-bar {
  width: 100%; max-width: 28px;
  background: var(--orange);
  border-radius: 3px 3px 0 0;
  transition: height 0.3s; min-height: 2px;
}
.trend-bar.blue { background: var(--blue); }
.trend-label {
  font-size: 10px; color: var(--text-dim);
  margin-top: 4px; font-family: var(--font-en);
}
.trend-value {
  font-size: 9px; color: var(--text-secondary);
  margin-bottom: 4px; font-family: var(--font-en);
  white-space: nowrap;
}
.trend-summary {
  display: flex; justify-content: space-between;
  padding: 8px 0; border-top: 1px solid rgba(255,255,255,0.08);
  margin-top: 8px; font-size: 12px; color: var(--text-secondary);
}
.trend-summary strong { color: var(--text-primary); font-family: var(--font-en); }

/* ==================== Modal ==================== */
.modal-overlay {
  display: none; position: fixed;
  top: 0; left: 0; right: 0; bottom: 0;
  background: rgba(0,0,0,0.7);
  z-index: 200; align-items: flex-end;
  justify-content: center;
}
.modal-overlay.active { display: flex; }
.modal-box {
  background: var(--black);
  border-radius: 16px 16px 0 0;
  width: 100%; max-width: 640px;
  max-height: 85vh; overflow-y: auto;
  padding: 20px; animation: slideUp 0.25s ease;
}
.modal-box h3 { font-size: 16px; margin-bottom: 16px; }
.modal-close {
  float: right; background: none; border: none;
  color: var(--text-dim); font-size: 24px;
  cursor: pointer; padding: 0 4px;
}
.modal-close:hover { color: var(--text-primary); }

/* ==================== Toast ==================== */
.toast {
  position: fixed; top: 16px; left: 50%;
  transform: translateX(-50%);
  background: var(--dark-gray);
  border: 1px solid rgba(255,255,255,0.1);
  border-radius: var(--radius-sm);
  padding: 12px 20px; font-size: 13px;
  z-index: 999; animation: fadeSlideIn 0.3s ease;
  box-shadow: 0 4px 20px rgba(0,0,0,0.4);
  max-width: 90%; text-align: center;
}
.toast.success { border-color: var(--success); color: var(--success); }
.toast.error { border-color: var(--danger); color: var(--danger); }
.toast.info { border-color: var(--blue); color: var(--blue); }

/* ==================== 產品目錄管理 ==================== */
.product-list-item {
  display: flex; justify-content: space-between;
  align-items: center; padding: 10px 0;
  border-bottom: 1px solid rgba(255,255,255,0.05);
}
.product-list-item:last-child { border-bottom: none; }
.product-info { flex: 1; }
.product-name { font-size: 14px; font-weight: 500; }
.product-spec { font-size: 12px; color: var(--text-secondary); }
.product-price {
  font-family: var(--font-en); font-size: 14px;
  font-weight: 600; color: var(--orange); margin-right: 12px;
}

/* ==================== 動畫 ==================== */
@keyframes fadeSlideIn {
  from { opacity: 0; transform: translateX(-50%) translateY(-12px); }
  to { opacity: 1; transform: translateX(-50%) translateY(0); }
}
@keyframes slideUp {
  from { transform: translateY(100%); }
  to { transform: translateY(0); }
}

/* ==================== 響應式 ==================== */
@media (max-width: 380px) {
  .tab-btn { font-size: 11px; padding: 8px 4px; }
  .tab-icon { font-size: 14px; }
  .form-row, .line-item-row { grid-template-columns: 1fr; }
}
</style>
</head>
<body>

<!-- ==================== 頂部品牌列 ==================== -->
<div class="top-bar">
  <div class="brand">
    <div class="brand-icon">🥜</div>
    <div>
      <div class="brand-name">Outrun Nutrition</div>
      <div class="brand-sub">報價 / 採購管理</div>
    </div>
  </div>
  <div class="sync-status">
    <div class="sync-dot" id="syncDot"></div>
    <span id="syncLabel">本機</span>
  </div>
</div>

<!-- ==================== 分頁導覽 ==================== -->
<nav class="tab-nav">
  <button class="tab-btn active" onclick="switchTab('quote')">
    <span class="tab-icon">📝</span>新增報價
  </button>
  <button class="tab-btn" onclick="switchTab('po')">
    <span class="tab-icon">📦</span>新增採購
  </button>
  <button class="tab-btn" onclick="switchTab('list')">
    <span class="tab-icon">📋</span>單據列表
  </button>
  <button class="tab-btn" onclick="switchTab('stats')">
    <span class="tab-icon">📊</span>統計
  </button>
  <button class="tab-btn" onclick="switchTab('settings')">
    <span class="tab-icon">⚙️</span>設定
  </button>
</nav>

<div class="main-content">

<!-- ==================== Tab 1: 新增報價單 ==================== -->
<div id="tab-quote" class="tab-panel active">
  <div class="card">
    <div class="card-header">
      <span class="card-title">📝 報價單</span>
      <span class="card-badge">QUOTATION</span>
    </div>

    <!-- 日期 -->
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">報價日期</label>
        <input type="date" id="quoteDate" class="form-input">
      </div>
      <div class="form-group">
        <label class="form-label">有效期限</label>
        <input type="date" id="quoteValidUntil" class="form-input">
      </div>
    </div>

    <!-- 客戶資訊 -->
    <div class="form-group">
      <label class="form-label">客戶名稱 <span class="required">*</span></label>
      <input type="text" id="quoteCustName" class="form-input" placeholder="公司或個人名稱">
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">聯繫人</label>
        <input type="text" id="quoteCustContact" class="form-input" placeholder="姓名">
      </div>
      <div class="form-group">
        <label class="form-label">電話</label>
        <input type="tel" id="quoteCustPhone" class="form-input" placeholder="09xx-xxx-xxx">
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">Email</label>
        <input type="email" id="quoteCustEmail" class="form-input" placeholder="email@example.com">
      </div>
      <div class="form-group">
        <label class="form-label">地址</label>
        <input type="text" id="quoteCustAddr" class="form-input" placeholder="送貨/通訊地址">
      </div>
    </div>
  </div>

  <!-- 商品明細 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">商品明細</span>
      <span class="card-badge" id="quoteItemCount">0 ITEMS</span>
    </div>
    <div id="quoteLineItems" class="line-items"></div>
    <button class="add-line-btn" onclick="addQuoteLineItem()">+ 新增品項</button>

    <!-- 金額匯總 -->
    <div class="amount-summary">
      <div class="amount-row">
        <span class="label">小計</span>
        <span class="value" id="quoteSubtotal">NTD 0</span>
      </div>
      <div class="form-row" style="margin:8px 0">
        <div class="form-group" style="margin:0">
          <select id="quoteDiscountType" class="form-select" onchange="calcQuoteTotals()" style="font-size:13px;padding:8px">
            <option value="percent">折扣 %</option>
            <option value="fixed">折扣金額</option>
          </select>
        </div>
        <div class="form-group" style="margin:0">
          <input type="number" id="quoteDiscountValue" class="form-input" value="0" min="0" oninput="calcQuoteTotals()" style="font-size:13px;padding:8px">
        </div>
      </div>
      <div class="amount-row discount">
        <span class="label">折扣</span>
        <span class="value" id="quoteDiscountAmount">-NTD 0</span>
      </div>
      <div class="form-group" style="margin:8px 0 4px">
        <select id="quoteTaxType" class="form-select" onchange="calcQuoteTotals()" style="font-size:13px;padding:8px">
          <option value="excluded">稅外加 (5%)</option>
          <option value="included">含稅 (5%)</option>
          <option value="exempt">免稅</option>
        </select>
      </div>
      <div class="amount-row">
        <span class="label" id="quoteTaxLabel">稅額 (5%)</span>
        <span class="value" id="quoteTaxAmount">NTD 0</span>
      </div>
      <div class="amount-row total">
        <span class="label">總計</span>
        <span class="value" id="quoteTotal">NTD 0</span>
      </div>
    </div>
  </div>

  <!-- 備註 -->
  <div class="card">
    <div class="form-group" style="margin:0">
      <label class="form-label">備註</label>
      <textarea id="quoteNotes" class="form-textarea" placeholder="付款條件、交貨方式等補充說明"></textarea>
    </div>
  </div>

  <div class="btn-group">
    <button class="btn btn-primary" onclick="saveQuotation()" style="flex:2">儲存報價單</button>
    <button class="btn btn-secondary" onclick="saveQuotation(true)" style="flex:1">存檔+PDF</button>
  </div>
</div>

<!-- ==================== Tab 2: 新增採購單 ==================== -->
<div id="tab-po" class="tab-panel">
  <div class="card">
    <div class="card-header">
      <span class="card-title">📦 採購單</span>
      <span class="card-badge">PURCHASE ORDER</span>
    </div>

    <div class="form-group">
      <label class="form-label">採購日期</label>
      <input type="date" id="poDate" class="form-input">
    </div>

    <!-- 供應商 -->
    <div class="form-group">
      <label class="form-label">供應商名稱 <span class="required">*</span></label>
      <input type="text" id="poVendorName" class="form-input" placeholder="供應商名稱">
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">聯繫人</label>
        <input type="text" id="poVendorContact" class="form-input" placeholder="姓名">
      </div>
      <div class="form-group">
        <label class="form-label">電話</label>
        <input type="tel" id="poVendorPhone" class="form-input" placeholder="電話">
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">Email</label>
      <input type="email" id="poVendorEmail" class="form-input" placeholder="email@example.com">
    </div>
  </div>

  <!-- 採購明細 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">採購明細</span>
      <span class="card-badge" id="poItemCount">0 ITEMS</span>
    </div>
    <div id="poLineItems" class="line-items"></div>
    <button class="add-line-btn" onclick="addPOLineItem()">+ 新增品項</button>

    <div class="amount-summary">
      <div class="amount-row">
        <span class="label">小計</span>
        <span class="value" id="poSubtotal">NTD 0</span>
      </div>
      <div class="form-group" style="margin:8px 0 4px">
        <select id="poTaxType" class="form-select" onchange="calcPOTotals()" style="font-size:13px;padding:8px">
          <option value="excluded">稅外加 (5%)</option>
          <option value="included">含稅 (5%)</option>
          <option value="exempt">免稅</option>
        </select>
      </div>
      <div class="amount-row">
        <span class="label" id="poTaxLabel">稅額 (5%)</span>
        <span class="value" id="poTaxAmount">NTD 0</span>
      </div>
      <div class="amount-row total">
        <span class="label">總計</span>
        <span class="value" id="poTotal">NTD 0</span>
      </div>
    </div>
  </div>

  <!-- 交貨與付款 -->
  <div class="card">
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">預期交貨日</label>
        <input type="date" id="poDeliveryDate" class="form-input">
      </div>
      <div class="form-group">
        <label class="form-label">付款條件</label>
        <select id="poPaymentTerms" class="form-select">
          <option value="月結30天">月結30天</option>
          <option value="月結60天">月結60天</option>
          <option value="貨到付款">貨到付款</option>
          <option value="預付款">預付款</option>
          <option value="其他">其他</option>
        </select>
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">關聯報價單</label>
      <select id="poRelatedQuote" class="form-select">
        <option value="">（無）</option>
      </select>
    </div>
    <div class="form-group" style="margin:0">
      <label class="form-label">備註</label>
      <textarea id="poNotes" class="form-textarea" placeholder="特殊需求、注意事項"></textarea>
    </div>
  </div>

  <div class="btn-group">
    <button class="btn btn-primary" onclick="savePurchaseOrder()" style="flex:2">儲存採購單</button>
    <button class="btn btn-secondary" onclick="savePurchaseOrder(true)" style="flex:1">存檔+PDF</button>
  </div>
</div>

<!-- ==================== Tab 3: 單據列表 ==================== -->
<div id="tab-list" class="tab-panel">
  <div class="month-nav">
    <button onclick="changeListMonth(-1)">◀</button>
    <span class="month-label" id="listMonthLabel"></span>
    <button onclick="changeListMonth(1)">▶</button>
  </div>

  <div class="search-bar">
    <input type="text" id="listSearch" placeholder="搜尋編號、客戶、供應商" oninput="renderDocList()">
    <select id="listTypeFilter" onchange="renderDocList()">
      <option value="">全部</option>
      <option value="quotation">報價單</option>
      <option value="po">採購單</option>
    </select>
  </div>

  <div id="docListContainer"></div>
  <div id="docListEmpty" style="text-align:center;padding:40px 0;color:var(--text-dim);display:none">
    <div style="font-size:40px;margin-bottom:8px">📄</div>
    <div>本月尚無單據</div>
  </div>
</div>

<!-- ==================== Tab 4: 統計 ==================== -->
<div id="tab-stats" class="tab-panel">
  <div class="month-nav">
    <button onclick="changeStatsMonth(-1)">◀</button>
    <span class="month-label" id="statsMonthLabel"></span>
    <button onclick="changeStatsMonth(1)">▶</button>
  </div>

  <div class="stats-grid">
    <div class="stat-card">
      <div class="stat-label">報價單數</div>
      <div class="stat-value" id="statQuoteCount">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">採購單數</div>
      <div class="stat-value" id="statPOCount">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">報價總額</div>
      <div class="stat-value orange" id="statQuoteTotal">0</div>
    </div>
    <div class="stat-card">
      <div class="stat-label">採購總額</div>
      <div class="stat-value orange" id="statPOTotal">0</div>
    </div>
  </div>

  <!-- 報價單狀態分布 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">報價單狀態分布</span>
    </div>
    <div id="quoteStatusDist"></div>
  </div>

  <!-- 年度趨勢 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">年度趨勢</span>
      <select id="trendYear" class="form-select" onchange="renderTrend()" style="width:auto;padding:4px 28px 4px 8px;font-size:12px"></select>
    </div>
    <div id="trendChart" class="trend-chart"></div>
    <div id="trendSummary" class="trend-summary"></div>
  </div>
</div>

<!-- ==================== Tab 5: 設定 ==================== -->
<div id="tab-settings" class="tab-panel">
  <div class="card">
    <div class="card-header">
      <span class="card-title">⚙️ 系統設定</span>
      <span class="card-badge">SETTINGS</span>
    </div>
    <div class="form-group">
      <label class="form-label">Apps Script API 網址</label>
      <input type="url" id="settingApiUrl" class="form-input" placeholder="https://script.google.com/macros/s/...">
    </div>
    <div class="form-group">
      <label class="form-label">使用者名稱</label>
      <input type="text" id="settingRecorder" class="form-input" placeholder="你的名字">
    </div>
  </div>

  <!-- 公司資訊 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">公司資訊（用於 PDF）</span>
    </div>
    <div class="form-group">
      <label class="form-label">公司名稱（中文品牌）</label>
      <input type="text" id="settingCompanyName" class="form-input" value="堅心 Outrun Nutrition">
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">法人名稱</label>
        <input type="text" id="settingLegalName" class="form-input" placeholder="焠爾瑯股份有限公司">
      </div>
      <div class="form-group">
        <label class="form-label">英文名稱</label>
        <input type="text" id="settingNameEn" class="form-input" placeholder="Outrun Nutrition Co., Ltd.">
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">統一編號</label>
        <input type="text" id="settingTaxId" class="form-input" placeholder="91114185">
      </div>
      <div class="form-group">
        <label class="form-label">電話</label>
        <input type="tel" id="settingCompanyPhone" class="form-input" placeholder="02-xxxx-xxxx">
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">Email</label>
      <input type="email" id="settingCompanyEmail" class="form-input" placeholder="info@outrun.com">
    </div>
    <div class="form-group">
      <label class="form-label">地址</label>
      <input type="text" id="settingCompanyAddr" class="form-input" placeholder="公司地址">
    </div>
  </div>

  <!-- 業務代表 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">業務代表（PDF 顯示）</span>
    </div>
    <div class="form-group">
      <label class="form-label">業務名稱</label>
      <input type="text" id="settingSalesName" class="form-input" placeholder="業務代表姓名">
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">電話</label>
        <input type="tel" id="settingSalesPhone" class="form-input" placeholder="0912-345-678">
      </div>
      <div class="form-group">
        <label class="form-label">Email</label>
        <input type="email" id="settingSalesEmail" class="form-input" placeholder="sales@outrun.com">
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">LINE ID</label>
      <input type="text" id="settingSalesLine" class="form-input" placeholder="LINE ID 或顯示名稱">
    </div>
  </div>

  <!-- 匯款資訊 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">匯款資訊（PDF 顯示）</span>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">銀行名稱</label>
        <input type="text" id="settingBankName" class="form-input" placeholder="玉山銀行">
      </div>
      <div class="form-group">
        <label class="form-label">銀行代碼</label>
        <input type="text" id="settingBankCode" class="form-input" placeholder="808">
      </div>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">分行名稱（代碼）</label>
        <input type="text" id="settingBankBranch" class="form-input" placeholder="北新分行 (0901)">
      </div>
      <div class="form-group">
        <label class="form-label">戶名</label>
        <input type="text" id="settingBankHolder" class="form-input" placeholder="焠爾瑯股份有限公司">
      </div>
    </div>
    <div class="form-group">
      <label class="form-label">帳號</label>
      <input type="text" id="settingBankAccount" class="form-input" placeholder="0901-9400-22708">
    </div>
  </div>

  <!-- PDF 圖片上傳 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">PDF 圖片設定</span>
    </div>
    <div class="form-group">
      <label class="form-label">公司 Logo（左上角顯示）</label>
      <div id="logoPreview" style="margin-bottom:8px"></div>
      <input type="file" id="logoUpload" accept="image/*" onchange="handleImageUpload('logo', this)" style="display:none">
      <div class="btn-group">
        <button class="btn btn-outline btn-sm" onclick="document.getElementById('logoUpload').click()" style="flex:1">📷 上傳 Logo</button>
        <button class="btn btn-outline btn-sm" onclick="clearImage('logo')" style="flex:0.5;color:var(--danger)">清除</button>
      </div>
    </div>
    <div class="form-group" style="margin-top:12px">
      <label class="form-label">公司發票章（右下角簽署區顯示）</label>
      <div id="stampPreview" style="margin-bottom:8px"></div>
      <input type="file" id="stampUpload" accept="image/*" onchange="handleImageUpload('stamp', this)" style="display:none">
      <div class="btn-group">
        <button class="btn btn-outline btn-sm" onclick="document.getElementById('stampUpload').click()" style="flex:1">📷 上傳發票章</button>
        <button class="btn btn-outline btn-sm" onclick="clearImage('stamp')" style="flex:0.5;color:var(--danger)">清除</button>
      </div>
    </div>
  </div>

  <!-- PDF 備註條款 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">PDF 預設備註條款</span>
    </div>
    <div class="form-group">
      <label class="form-label">備註條款（每行一條）</label>
      <textarea id="settingPdfTerms" class="form-input" rows="4" placeholder="1. 本報價單有效期限為開立日起 30 天。&#10;2. 付款方式：匯款。"></textarea>
    </div>
  </div>

  <!-- 產品目錄 -->
  <div class="card">
    <div class="card-header">
      <span class="card-title">產品目錄</span>
      <span class="card-badge" id="productCountBadge">0</span>
    </div>
    <div id="productList"></div>
    <div style="border-top:1px solid rgba(255,255,255,0.08);padding-top:12px;margin-top:12px">
      <div class="form-group">
        <label class="form-label">新增自訂產品</label>
        <div class="form-row" style="margin-bottom:8px">
          <input type="text" id="newProdName" class="form-input" placeholder="品名" style="font-size:13px;padding:8px">
          <input type="text" id="newProdSpec" class="form-input" placeholder="規格" style="font-size:13px;padding:8px">
        </div>
        <div class="form-row">
          <input type="number" id="newProdPrice" class="form-input" placeholder="售價" style="font-size:13px;padding:8px">
          <input type="text" id="newProdUnit" class="form-input" placeholder="單位(預設:個)" style="font-size:13px;padding:8px">
        </div>
      </div>
      <button class="btn btn-outline btn-sm" onclick="addCustomProduct()" style="width:100%">+ 新增產品</button>
    </div>
  </div>

  <button class="btn btn-primary" onclick="saveSettings()">儲存設定</button>
  <div class="btn-group">
    <button class="btn btn-outline btn-sm" onclick="syncToCloud()" style="flex:1">☁️ 雲端同步</button>
    <button class="btn btn-danger btn-sm" onclick="clearLocalData()" style="flex:1">🗑️ 清除本地資料</button>
  </div>
</div>

</div><!-- /main-content -->

<!-- ==================== Modal ==================== -->
<div class="modal-overlay" id="docModal">
  <div class="modal-box">
    <button class="modal-close" onclick="closeModal()">&times;</button>
    <div id="modalContent"></div>
  </div>
</div>

<!-- ==================== JavaScript ==================== -->
<script>
// ==================== 預設產品目錄 ====================
const DEFAULT_PRODUCTS = [
  { name: '眠易復 運動恢復膠囊', spec: '30粒/罐', price: 1299, unit: '罐' },
  { name: '能易復 恢復蛋白', spec: '黑糖仙草 750g/袋', price: 1350, unit: '袋' },
  { name: '能易復 恢復蛋白', spec: '黑糖仙草 500g/盒', price: 950, unit: '盒' },
  { name: '食動力 運動體感膠囊', spec: '30包/盒', price: 1299, unit: '盒' },
  { name: 'TEMPO 膠囊', spec: '60顆/罐', price: 1299, unit: '罐' },
  { name: 'OARC 專業科學訓練補給組', spec: '隨選組合', price: 0, unit: '組' },
];

// ==================== 狀態常數 ====================
const QUOTE_STATUSES = ['草稿', '已發送', '已接受', '已拒絕'];
const PO_STATUSES = ['待確認', '已確認', '已交貨', '已開票', '已結款'];

const STORAGE_KEYS = {
  QUOTATIONS: 'outrun_po_quotations',
  PURCHASE_ORDERS: 'outrun_po_purchase_orders',
  SETTINGS: 'outrun_po_settings',
  PRODUCTS: 'outrun_po_products',
  PENDING: 'outrun_po_pending',
};

// ==================== 預設圖片 ====================
const DEFAULT_LOGO_BASE64 = 'data:image/png;base64,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';
    const DEFAULT_STAMP_BASE64 = 'data:image/png;base64,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';

// ==================== State ====================
let state = {
  quotations: [],
  purchaseOrders: [],
  products: [],
  pendingSync: [],
  settings: {
    apiUrl: '',
    recorder: '',
    companyInfo: {
      name: '堅心 Outrun Nutrition',
      nameEn: 'Outrun Nutrition Co., Ltd.',
      legalName: '焠爾瑯股份有限公司',
      phone: '', email: '', address: '新北市新店區華興街46號1樓', taxId: '91114185'
    },
    salesRep: { name: '', phone: '', email: '', line: '' },
    bankInfo: { bankName: '玉山銀行', bankCode: '808', branch: '北新分行 (0901)', holder: '焠爾瑯股份有限公司', account: '0901-9400-22708' },
    logoBase64: '',
    stampBase64: '',
    pdfTerms: '1. 本報價單有效期限為開立日起 30 天。\n2. 付款方式：匯款。\n3. 商品交期依實際庫存狀況為準。'
  }
};

// 列表/統計的當前月份
let listYear, listMonth, statsYear, statsMonth;

// ==================== 工具函式 ====================
function numberFormat(n) {
  return Number(n || 0).toLocaleString('en-US');
}

function todayStr() {
  const d = new Date();
  return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0') + '-' + String(d.getDate()).padStart(2,'0');
}

function addDays(dateStr, days) {
  const d = new Date(dateStr);
  d.setDate(d.getDate() + days);
  return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0') + '-' + String(d.getDate()).padStart(2,'0');
}

function generateId(prefix) {
  const today = todayStr().replace(/-/g, '');
  const arr = prefix === 'QUOT' ? state.quotations : state.purchaseOrders;
  const todayDocs = arr.filter(d => d.id && d.id.startsWith(prefix + '-' + today));
  const seq = String(todayDocs.length + 1).padStart(3, '0');
  return prefix + '-' + today + '-' + seq;
}

function getStatusClass(status) {
  const map = {
    '草稿': 'status-draft', '已發送': 'status-sent',
    '已接受': 'status-accepted', '已拒絕': 'status-rejected',
    '待確認': 'status-pending', '已確認': 'status-confirmed',
    '已交貨': 'status-delivered', '已開票': 'status-invoiced',
    '已結款': 'status-paid',
  };
  return map[status] || 'status-draft';
}

function showToast(msg, type = 'info') {
  const existing = document.querySelector('.toast');
  if (existing) existing.remove();
  const el = document.createElement('div');
  el.className = 'toast ' + type;
  el.textContent = msg;
  document.body.appendChild(el);
  setTimeout(() => el.remove(), 3000);
}

// ==================== 分頁切換 ====================
function switchTab(tab) {
  document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  document.getElementById('tab-' + tab).classList.add('active');
  const tabs = ['quote', 'po', 'list', 'stats', 'settings'];
  const idx = tabs.indexOf(tab);
  if (idx >= 0) document.querySelectorAll('.tab-btn')[idx].classList.add('active');

  if (tab === 'list') renderDocList();
  if (tab === 'stats') renderStats();
  if (tab === 'settings') renderSettings();
  if (tab === 'po') populateRelatedQuotes();
}

// ==================== localStorage ====================
function saveState() {
  localStorage.setItem(STORAGE_KEYS.QUOTATIONS, JSON.stringify(state.quotations));
  localStorage.setItem(STORAGE_KEYS.PURCHASE_ORDERS, JSON.stringify(state.purchaseOrders));
  localStorage.setItem(STORAGE_KEYS.SETTINGS, JSON.stringify(state.settings));
  localStorage.setItem(STORAGE_KEYS.PRODUCTS, JSON.stringify(state.products));
  localStorage.setItem(STORAGE_KEYS.PENDING, JSON.stringify(state.pendingSync));
}

function loadState() {
  try {
    const q = localStorage.getItem(STORAGE_KEYS.QUOTATIONS);
    if (q) state.quotations = JSON.parse(q);
    const p = localStorage.getItem(STORAGE_KEYS.PURCHASE_ORDERS);
    if (p) state.purchaseOrders = JSON.parse(p);
    const s = localStorage.getItem(STORAGE_KEYS.SETTINGS);
    if (s) state.settings = { ...state.settings, ...JSON.parse(s) };
    const pr = localStorage.getItem(STORAGE_KEYS.PRODUCTS);
    if (pr) state.products = JSON.parse(pr);
    else state.products = [...DEFAULT_PRODUCTS];
    const pn = localStorage.getItem(STORAGE_KEYS.PENDING);
    if (pn) state.pendingSync = JSON.parse(pn);
  } catch (e) {
    console.error('loadState error', e);
    state.products = [...DEFAULT_PRODUCTS];
  }
  // Logo 預設值：若 localStorage 中無自訂 Logo，使用內建預設
  if (!state.settings.logoBase64) {
    state.settings.logoBase64 = DEFAULT_LOGO_BASE64;
  }
  // 發票章預設值：若 localStorage 中無自訂發票章，使用內建預設
  if (!state.settings.stampBase64) {
    state.settings.stampBase64 = DEFAULT_STAMP_BASE64;
  }
  // 確保舊版 localStorage 中缺少的欄位用預設值填充
  if (!state.settings.bankInfo) state.settings.bankInfo = {};
  if (!state.settings.bankInfo.branch) state.settings.bankInfo.branch = '北新分行 (0901)';
  if (!state.settings.bankInfo.holder) state.settings.bankInfo.holder = '焠爾瑯股份有限公司';
}

// ==================== 報價單明細行 ====================
let quoteLineCounter = 0;

function addQuoteLineItem(data) {
  quoteLineCounter++;
  const n = quoteLineCounter;
  const container = document.getElementById('quoteLineItems');

  const productOptions = state.products.map((p, i) =>
    `<option value="${i}" ${data && data.productName === p.name ? 'selected' : ''}>${p.name} (${p.spec})</option>`
  ).join('');

  const div = document.createElement('div');
  div.className = 'line-item';
  div.id = 'quoteLine-' + n;
  div.innerHTML = `
    <div class="line-item-header">
      <span class="line-item-num">#${n}</span>
      <button class="line-item-remove" onclick="removeQuoteLine(${n})">✕</button>
    </div>
    <div class="form-group">
      <label class="form-label">產品</label>
      <select class="form-select" onchange="onQuoteProductSelect(${n}, this.value)" id="qProd-${n}">
        <option value="">— 自訂輸入 —</option>
        ${productOptions}
      </select>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">品名</label>
        <input type="text" class="form-input" id="qName-${n}" value="${data ? data.productName : ''}" oninput="calcQuoteTotals()">
      </div>
      <div class="form-group">
        <label class="form-label">規格</label>
        <input type="text" class="form-input" id="qSpec-${n}" value="${data ? data.spec : ''}">
      </div>
    </div>
    <div class="line-item-row">
      <div class="form-group">
        <label class="form-label">數量</label>
        <input type="number" class="form-input" id="qQty-${n}" value="${data ? data.qty : 1}" min="1" oninput="calcQuoteLineSubtotal(${n})">
      </div>
      <div class="form-group">
        <label class="form-label">單位</label>
        <input type="text" class="form-input" id="qUnit-${n}" value="${data ? data.unit : '個'}">
      </div>
      <div class="form-group">
        <label class="form-label">單價</label>
        <input type="number" class="form-input" id="qPrice-${n}" value="${data ? data.unitPrice : 0}" min="0" oninput="calcQuoteLineSubtotal(${n})">
      </div>
    </div>
    <div class="line-item-subtotal" id="qSubtotal-${n}">NTD 0</div>
  `;
  container.appendChild(div);
  calcQuoteLineSubtotal(n);
  updateQuoteItemCount();
}

function onQuoteProductSelect(n, idx) {
  if (idx === '') return;
  const p = state.products[parseInt(idx)];
  if (!p) return;
  document.getElementById('qName-' + n).value = p.name;
  document.getElementById('qSpec-' + n).value = p.spec;
  document.getElementById('qPrice-' + n).value = p.price;
  document.getElementById('qUnit-' + n).value = p.unit;
  calcQuoteLineSubtotal(n);
}

function removeQuoteLine(n) {
  const el = document.getElementById('quoteLine-' + n);
  if (el) el.remove();
  calcQuoteTotals();
  updateQuoteItemCount();
}

function calcQuoteLineSubtotal(n) {
  const qty = Number(document.getElementById('qQty-' + n)?.value) || 0;
  const price = Number(document.getElementById('qPrice-' + n)?.value) || 0;
  const sub = qty * price;
  const el = document.getElementById('qSubtotal-' + n);
  if (el) el.textContent = 'NTD ' + numberFormat(sub);
  calcQuoteTotals();
}

function getQuoteLineItems() {
  const items = [];
  document.querySelectorAll('#quoteLineItems .line-item').forEach(li => {
    const n = li.id.replace('quoteLine-', '');
    const qty = Number(document.getElementById('qQty-' + n)?.value) || 0;
    const unitPrice = Number(document.getElementById('qPrice-' + n)?.value) || 0;
    items.push({
      productName: document.getElementById('qName-' + n)?.value || '',
      spec: document.getElementById('qSpec-' + n)?.value || '',
      qty, unit: document.getElementById('qUnit-' + n)?.value || '個',
      unitPrice, subtotal: qty * unitPrice,
    });
  });
  return items;
}

function updateQuoteItemCount() {
  const count = document.querySelectorAll('#quoteLineItems .line-item').length;
  document.getElementById('quoteItemCount').textContent = count + ' ITEMS';
}

function calcQuoteTotals() {
  const items = getQuoteLineItems();
  const subtotal = items.reduce((s, i) => s + i.subtotal, 0);

  const discType = document.getElementById('quoteDiscountType').value;
  const discVal = Number(document.getElementById('quoteDiscountValue').value) || 0;
  let discAmount = 0;
  if (discType === 'percent') discAmount = Math.round(subtotal * discVal / 100);
  else discAmount = discVal;

  const afterDiscount = subtotal - discAmount;
  const taxType = document.getElementById('quoteTaxType').value;
  let tax = 0, total = 0;
  const taxLabel = document.getElementById('quoteTaxLabel');

  if (taxType === 'excluded') {
    tax = Math.round(afterDiscount * 0.05);
    total = afterDiscount + tax;
    taxLabel.textContent = '稅額 (外加 5%)';
  } else if (taxType === 'included') {
    tax = Math.round(afterDiscount - afterDiscount / 1.05);
    total = afterDiscount;
    taxLabel.textContent = '稅額 (內含 5%)';
  } else {
    tax = 0;
    total = afterDiscount;
    taxLabel.textContent = '稅額 (免稅)';
  }

  document.getElementById('quoteSubtotal').textContent = 'NTD ' + numberFormat(subtotal);
  document.getElementById('quoteDiscountAmount').textContent = '-NTD ' + numberFormat(discAmount);
  document.getElementById('quoteTaxAmount').textContent = 'NTD ' + numberFormat(tax);
  document.getElementById('quoteTotal').textContent = 'NTD ' + numberFormat(total);
}

// ==================== 採購單明細行 ====================
let poLineCounter = 0;

function addPOLineItem(data) {
  poLineCounter++;
  const n = poLineCounter;
  const container = document.getElementById('poLineItems');

  const div = document.createElement('div');
  div.className = 'line-item';
  div.id = 'poLine-' + n;
  div.innerHTML = `
    <div class="line-item-header">
      <span class="line-item-num">#${n}</span>
      <button class="line-item-remove" onclick="removePOLine(${n})">✕</button>
    </div>
    <div class="form-row">
      <div class="form-group">
        <label class="form-label">品名</label>
        <input type="text" class="form-input" id="pName-${n}" value="${data ? data.itemName : ''}" oninput="calcPOTotals()">
      </div>
      <div class="form-group">
        <label class="form-label">規格</label>
        <input type="text" class="form-input" id="pSpec-${n}" value="${data ? data.spec : ''}">
      </div>
    </div>
    <div class="line-item-row">
      <div class="form-group">
        <label class="form-label">數量</label>
        <input type="number" class="form-input" id="pQty-${n}" value="${data ? data.qty : 1}" min="1" oninput="calcPOLineSubtotal(${n})">
      </div>
      <div class="form-group">
        <label class="form-label">單位</label>
        <input type="text" class="form-input" id="pUnit-${n}" value="${data ? data.unit : '個'}">
      </div>
      <div class="form-group">
        <label class="form-label">單價</label>
        <input type="number" class="form-input" id="pPrice-${n}" value="${data ? data.unitPrice : 0}" min="0" oninput="calcPOLineSubtotal(${n})">
      </div>
    </div>
    <div class="line-item-subtotal" id="pSubtotal-${n}">NTD 0</div>
  `;
  container.appendChild(div);
  calcPOLineSubtotal(n);
  updatePOItemCount();
}

function removePOLine(n) {
  const el = document.getElementById('poLine-' + n);
  if (el) el.remove();
  calcPOTotals();
  updatePOItemCount();
}

function calcPOLineSubtotal(n) {
  const qty = Number(document.getElementById('pQty-' + n)?.value) || 0;
  const price = Number(document.getElementById('pPrice-' + n)?.value) || 0;
  const sub = qty * price;
  const el = document.getElementById('pSubtotal-' + n);
  if (el) el.textContent = 'NTD ' + numberFormat(sub);
  calcPOTotals();
}

function getPOLineItems() {
  const items = [];
  document.querySelectorAll('#poLineItems .line-item').forEach(li => {
    const n = li.id.replace('poLine-', '');
    const qty = Number(document.getElementById('pQty-' + n)?.value) || 0;
    const unitPrice = Number(document.getElementById('pPrice-' + n)?.value) || 0;
    items.push({
      itemName: document.getElementById('pName-' + n)?.value || '',
      spec: document.getElementById('pSpec-' + n)?.value || '',
      qty, unit: document.getElementById('pUnit-' + n)?.value || '個',
      unitPrice, subtotal: qty * unitPrice,
    });
  });
  return items;
}

function updatePOItemCount() {
  const count = document.querySelectorAll('#poLineItems .line-item').length;
  document.getElementById('poItemCount').textContent = count + ' ITEMS';
}

function calcPOTotals() {
  const items = getPOLineItems();
  const subtotal = items.reduce((s, i) => s + i.subtotal, 0);
  const taxType = document.getElementById('poTaxType').value;
  let tax = 0, total = 0;
  const taxLabel = document.getElementById('poTaxLabel');

  if (taxType === 'excluded') {
    tax = Math.round(subtotal * 0.05);
    total = subtotal + tax;
    taxLabel.textContent = '稅額 (外加 5%)';
  } else if (taxType === 'included') {
    tax = Math.round(subtotal - subtotal / 1.05);
    total = subtotal;
    taxLabel.textContent = '稅額 (內含 5%)';
  } else {
    tax = 0;
    total = subtotal;
    taxLabel.textContent = '稅額 (免稅)';
  }

  document.getElementById('poSubtotal').textContent = 'NTD ' + numberFormat(subtotal);
  document.getElementById('poTaxAmount').textContent = 'NTD ' + numberFormat(tax);
  document.getElementById('poTotal').textContent = 'NTD ' + numberFormat(total);
}

function populateRelatedQuotes() {
  const sel = document.getElementById('poRelatedQuote');
  sel.innerHTML = '<option value="">（無）</option>';
  state.quotations.filter(q => q.status === '已接受').forEach(q => {
    sel.innerHTML += `<option value="${q.id}">${q.id} — ${q.customer.name} (NTD ${numberFormat(q.total)})</option>`;
  });
}

// ==================== 儲存報價單 ====================
function saveQuotation(genPDF = false) {
  const custName = document.getElementById('quoteCustName').value.trim();
  if (!custName) { showToast('請輸入客戶名稱', 'error'); return; }
  const items = getQuoteLineItems();
  if (items.length === 0) { showToast('請新增至少一個品項', 'error'); return; }

  const subtotal = items.reduce((s, i) => s + i.subtotal, 0);
  const discType = document.getElementById('quoteDiscountType').value;
  const discVal = Number(document.getElementById('quoteDiscountValue').value) || 0;
  let discAmount = discType === 'percent' ? Math.round(subtotal * discVal / 100) : discVal;
  const afterDisc = subtotal - discAmount;
  const taxType = document.getElementById('quoteTaxType').value;
  let tax = 0, total = 0, taxRate = 0;
  if (taxType === 'excluded') { tax = Math.round(afterDisc * 0.05); total = afterDisc + tax; taxRate = 0.05; }
  else if (taxType === 'included') { tax = Math.round(afterDisc - afterDisc / 1.05); total = afterDisc; taxRate = 0.05; }
  else { tax = 0; total = afterDisc; taxRate = 0; }

  const quotation = {
    id: generateId('QUOT'),
    date: document.getElementById('quoteDate').value || todayStr(),
    validUntil: document.getElementById('quoteValidUntil').value || addDays(todayStr(), 30),
    customer: {
      name: custName,
      contact: document.getElementById('quoteCustContact').value.trim(),
      phone: document.getElementById('quoteCustPhone').value.trim(),
      email: document.getElementById('quoteCustEmail').value.trim(),
      address: document.getElementById('quoteCustAddr').value.trim(),
    },
    items, subtotal,
    discountType: discType, discountValue: discVal, discountAmount: discAmount,
    taxType, taxRate, taxAmount: tax, total,
    notes: document.getElementById('quoteNotes').value.trim(),
    status: '草稿',
    recorder: state.settings.recorder || '未設定',
    createdAt: new Date().toISOString(),
    synced: false,
  };

  state.quotations.push(quotation);
  state.pendingSync.push({ type: 'addQuotation', data: quotation });
  saveState();
  showToast('報價單已儲存：' + quotation.id, 'success');

  if (genPDF) generateQuotePDF(quotation);
  resetQuoteForm();
}

function resetQuoteForm() {
  document.getElementById('quoteCustName').value = '';
  document.getElementById('quoteCustContact').value = '';
  document.getElementById('quoteCustPhone').value = '';
  document.getElementById('quoteCustEmail').value = '';
  document.getElementById('quoteCustAddr').value = '';
  document.getElementById('quoteNotes').value = '';
  document.getElementById('quoteDiscountValue').value = '0';
  document.getElementById('quoteTaxType').value = 'excluded';
  document.getElementById('quoteLineItems').innerHTML = '';
  quoteLineCounter = 0;
  initDateFields();
  calcQuoteTotals();
  updateQuoteItemCount();
}

// ==================== 儲存採購單 ====================
function savePurchaseOrder(genPDF = false) {
  const vendorName = document.getElementById('poVendorName').value.trim();
  if (!vendorName) { showToast('請輸入供應商名稱', 'error'); return; }
  const items = getPOLineItems();
  if (items.length === 0) { showToast('請新增至少一個品項', 'error'); return; }

  const subtotal = items.reduce((s, i) => s + i.subtotal, 0);
  const taxType = document.getElementById('poTaxType').value;
  let tax = 0, total = 0, taxRate = 0;
  if (taxType === 'excluded') { tax = Math.round(subtotal * 0.05); total = subtotal + tax; taxRate = 0.05; }
  else if (taxType === 'included') { tax = Math.round(subtotal - subtotal / 1.05); total = subtotal; taxRate = 0.05; }
  else { tax = 0; total = subtotal; taxRate = 0; }

  const po = {
    id: generateId('PO'),
    date: document.getElementById('poDate').value || todayStr(),
    vendor: {
      name: vendorName,
      contact: document.getElementById('poVendorContact').value.trim(),
      phone: document.getElementById('poVendorPhone').value.trim(),
      email: document.getElementById('poVendorEmail').value.trim(),
    },
    items, subtotal,
    taxType, taxRate, taxAmount: tax, total,
    expectedDelivery: document.getElementById('poDeliveryDate').value || '',
    paymentTerms: document.getElementById('poPaymentTerms').value,
    notes: document.getElementById('poNotes').value.trim(),
    status: '待確認',
    relatedQuotationId: document.getElementById('poRelatedQuote').value || '',
    recorder: state.settings.recorder || '未設定',
    createdAt: new Date().toISOString(),
    synced: false,
  };

  state.purchaseOrders.push(po);
  state.pendingSync.push({ type: 'addPurchaseOrder', data: po });
  saveState();
  showToast('採購單已儲存：' + po.id, 'success');

  if (genPDF) generatePOPDF(po);
  resetPOForm();
}

function resetPOForm() {
  document.getElementById('poVendorName').value = '';
  document.getElementById('poVendorContact').value = '';
  document.getElementById('poVendorPhone').value = '';
  document.getElementById('poVendorEmail').value = '';
  document.getElementById('poNotes').value = '';
  document.getElementById('poDeliveryDate').value = '';
  document.getElementById('poRelatedQuote').value = '';
  document.getElementById('poTaxType').value = 'excluded';
  document.getElementById('poLineItems').innerHTML = '';
  poLineCounter = 0;
  initDateFields();
  calcPOTotals();
  updatePOItemCount();
}

// ==================== 單據列表 ====================
function changeListMonth(delta) {
  listMonth += delta;
  if (listMonth > 12) { listMonth = 1; listYear++; }
  if (listMonth < 1) { listMonth = 12; listYear--; }
  renderDocList();
}

function renderDocList() {
  document.getElementById('listMonthLabel').textContent = listYear + ' / ' + String(listMonth).padStart(2, '0');
  const keyword = (document.getElementById('listSearch')?.value || '').trim().toLowerCase();
  const typeFilter = document.getElementById('listTypeFilter')?.value || '';

  let docs = [];

  if (typeFilter !== 'po') {
    state.quotations.forEach(q => {
      const d = new Date(q.date);
      if (d.getFullYear() === listYear && (d.getMonth()+1) === listMonth) {
        docs.push({ ...q, _type: 'quotation' });
      }
    });
  }
  if (typeFilter !== 'quotation') {
    state.purchaseOrders.forEach(p => {
      const d = new Date(p.date);
      if (d.getFullYear() === listYear && (d.getMonth()+1) === listMonth) {
        docs.push({ ...p, _type: 'po' });
      }
    });
  }

  if (keyword) {
    docs = docs.filter(d => {
      const haystack = [
        d.id, d._type === 'quotation' ? d.customer?.name : d.vendor?.name,
        d.notes, d.recorder
      ].join(' ').toLowerCase();
      return haystack.includes(keyword);
    });
  }

  docs.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));

  const container = document.getElementById('docListContainer');
  const empty = document.getElementById('docListEmpty');

  if (docs.length === 0) {
    container.innerHTML = '';
    empty.style.display = 'block';
    return;
  }
  empty.style.display = 'none';

  container.innerHTML = docs.map(d => {
    const isQuote = d._type === 'quotation';
    const name = isQuote ? (d.customer?.name || '') : (d.vendor?.name || '');
    const typeLabel = isQuote ? '報價' : '採購';
    return `
      <div class="doc-card" onclick="showDocDetail('${d._type}','${d.id}')">
        <div class="doc-card-top">
          <span class="doc-card-id">${d.id}</span>
          <span class="doc-card-date">${d.date}</span>
        </div>
        <div class="doc-card-mid">
          <span class="doc-card-name">${typeLabel}｜${name}</span>
          <span class="doc-card-amount">NTD ${numberFormat(d.total)}</span>
        </div>
        <div class="doc-card-bottom">
          <span class="doc-card-recorder">${d.recorder || ''}</span>
          <span class="status-tag ${getStatusClass(d.status)}">${d.status}</span>
        </div>
      </div>
    `;
  }).join('');
}

// ==================== 單據詳情 Modal ====================
function showDocDetail(type, id) {
  const doc = type === 'quotation'
    ? state.quotations.find(q => q.id === id)
    : state.purchaseOrders.find(p => p.id === id);
  if (!doc) return;

  const isQuote = type === 'quotation';
  const statuses = isQuote ? QUOTE_STATUSES : PO_STATUSES;
  const target = isQuote ? doc.customer : doc.vendor;
  const targetLabel = isQuote ? '客戶' : '供應商';

  let itemsHtml = doc.items.map((item, i) => `
    <div style="display:flex;justify-content:space-between;padding:6px 0;border-bottom:1px solid rgba(255,255,255,0.05);font-size:13px">
      <div>
        <div>${isQuote ? item.productName : item.itemName}</div>
        <div style="font-size:11px;color:var(--text-dim)">${item.spec} × ${item.qty} ${item.unit}</div>
      </div>
      <div style="font-family:var(--font-en);font-weight:600">NTD ${numberFormat(item.subtotal)}</div>
    </div>
  `).join('');

  let statusBtns = statuses.map(s =>
    `<button class="btn btn-sm ${doc.status === s ? 'btn-primary' : 'btn-outline'}"
      onclick="updateDocStatus('${type}','${id}','${s}')" style="flex:1">${s}</button>`
  ).join('');

  let extraBtns = '';
  if (isQuote && doc.status === '已接受') {
    extraBtns = `<button class="btn btn-secondary btn-sm" onclick="convertQuoteToPO('${id}')" style="width:100%;margin-top:8px">📦 轉為採購單</button>`;
  }

  const content = document.getElementById('modalContent');
  content.innerHTML = `
    <h3>${isQuote ? '📝 報價單' : '📦 採購單'} ${doc.id}</h3>
    <div style="font-size:13px;color:var(--text-secondary);margin-bottom:16px">
      <div>日期：${doc.date}${isQuote ? ' ｜ 有效至：' + doc.validUntil : ''}</div>
      <div>${targetLabel}：<strong style="color:var(--text-primary)">${target?.name || ''}</strong></div>
      ${target?.contact ? '<div>聯繫人：' + target.contact + (target.phone ? ' / ' + target.phone : '') + '</div>' : ''}
      ${target?.email ? '<div>Email：' + target.email : ''}
      ${!isQuote && doc.expectedDelivery ? '<div>預期交貨：' + doc.expectedDelivery + '</div>' : ''}
      ${!isQuote ? '<div>付款條件：' + doc.paymentTerms + '</div>' : ''}
      <div>建立人：${doc.recorder}</div>
    </div>

    <div class="card" style="padding:12px;margin-bottom:12px">
      ${itemsHtml}
      <div style="border-top:1px solid rgba(255,255,255,0.1);padding-top:8px;margin-top:8px;font-size:13px">
        <div style="display:flex;justify-content:space-between;padding:2px 0">
          <span style="color:var(--text-secondary)">小計</span>
          <span style="font-family:var(--font-en);font-weight:600">NTD ${numberFormat(doc.subtotal)}</span>
        </div>
        ${isQuote && doc.discountAmount ? `<div style="display:flex;justify-content:space-between;padding:2px 0">
          <span style="color:var(--text-secondary)">折扣</span>
          <span style="font-family:var(--font-en);font-weight:600;color:var(--success)">-NTD ${numberFormat(doc.discountAmount)}</span>
        </div>` : ''}
        <div style="display:flex;justify-content:space-between;padding:2px 0">
          <span style="color:var(--text-secondary)">稅額 (${doc.taxType === 'excluded' ? '外加 5%' : doc.taxType === 'included' ? '內含 5%' : '免稅'})</span>
          <span style="font-family:var(--font-en);font-weight:600">NTD ${numberFormat(doc.taxAmount)}</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:6px 0;border-top:2px solid var(--orange);margin-top:6px;font-size:16px">
          <span style="font-weight:700">總計</span>
          <span style="font-family:var(--font-en);font-weight:700;color:var(--orange)">NTD ${numberFormat(doc.total)}</span>
        </div>
      </div>
    </div>

    ${doc.notes ? `<div style="font-size:13px;color:var(--text-secondary);margin-bottom:12px">備註：${doc.notes}</div>` : ''}

    <div style="margin-bottom:8px;font-size:12px;color:var(--text-secondary)">狀態變更</div>
    <div class="btn-group" style="flex-wrap:wrap;margin-top:0">${statusBtns}</div>
    ${extraBtns}

    <div class="btn-group" style="margin-top:12px">
      <button class="btn btn-secondary btn-sm" onclick="${isQuote ? 'generateQuotePDF' : 'generatePOPDF'}(state.${isQuote ? 'quotations' : 'purchaseOrders'}.find(d=>d.id==='${id}'))" style="flex:1">📄 產生 PDF</button>
      <button class="btn btn-danger btn-sm" onclick="deleteDoc('${type}','${id}')" style="flex:1">🗑️ 刪除</button>
    </div>
  `;
  document.getElementById('docModal').classList.add('active');
}

function closeModal() {
  document.getElementById('docModal').classList.remove('active');
}

function updateDocStatus(type, id, newStatus) {
  if (type === 'quotation') {
    const q = state.quotations.find(d => d.id === id);
    if (q) q.status = newStatus;
  } else {
    const p = state.purchaseOrders.find(d => d.id === id);
    if (p) p.status = newStatus;
  }
  saveState();
  showToast('狀態已更新為「' + newStatus + '」', 'success');
  showDocDetail(type, id);
  renderDocList();
}

function deleteDoc(type, id) {
  if (!confirm('確定要刪除此單據嗎？此操作無法復原。')) return;
  if (type === 'quotation') {
    state.quotations = state.quotations.filter(d => d.id !== id);
  } else {
    state.purchaseOrders = state.purchaseOrders.filter(d => d.id !== id);
  }
  saveState();
  closeModal();
  renderDocList();
  showToast('已刪除', 'info');
}

function convertQuoteToPO(quoteId) {
  const q = state.quotations.find(d => d.id === quoteId);
  if (!q) return;
  closeModal();
  switchTab('po');

  document.getElementById('poVendorName').value = q.customer.name;
  document.getElementById('poVendorContact').value = q.customer.contact || '';
  document.getElementById('poVendorPhone').value = q.customer.phone || '';
  document.getElementById('poVendorEmail').value = q.customer.email || '';
  document.getElementById('poRelatedQuote').value = quoteId;

  document.getElementById('poLineItems').innerHTML = '';
  poLineCounter = 0;
  q.items.forEach(item => {
    addPOLineItem({
      itemName: item.productName,
      spec: item.spec,
      qty: item.qty,
      unit: item.unit,
      unitPrice: item.unitPrice,
    });
  });

  showToast('已帶入報價單資料，請確認後儲存', 'info');
}

// ==================== 統計 ====================
function changeStatsMonth(delta) {
  statsMonth += delta;
  if (statsMonth > 12) { statsMonth = 1; statsYear++; }
  if (statsMonth < 1) { statsMonth = 12; statsYear--; }
  renderStats();
}

function renderStats() {
  document.getElementById('statsMonthLabel').textContent = statsYear + ' / ' + String(statsMonth).padStart(2, '0');

  const monthQuotes = state.quotations.filter(q => {
    const d = new Date(q.date);
    return d.getFullYear() === statsYear && (d.getMonth()+1) === statsMonth;
  });
  const monthPOs = state.purchaseOrders.filter(p => {
    const d = new Date(p.date);
    return d.getFullYear() === statsYear && (d.getMonth()+1) === statsMonth;
  });

  document.getElementById('statQuoteCount').textContent = monthQuotes.length;
  document.getElementById('statPOCount').textContent = monthPOs.length;
  document.getElementById('statQuoteTotal').textContent = numberFormat(monthQuotes.reduce((s, q) => s + q.total, 0));
  document.getElementById('statPOTotal').textContent = numberFormat(monthPOs.reduce((s, p) => s + p.total, 0));

  // 狀態分布
  const distHtml = QUOTE_STATUSES.map(s => {
    const count = monthQuotes.filter(q => q.status === s).length;
    return `<div style="display:flex;justify-content:space-between;padding:6px 0;font-size:13px">
      <span class="status-tag ${getStatusClass(s)}">${s}</span>
      <span style="font-family:var(--font-en);font-weight:600">${count}</span>
    </div>`;
  }).join('');
  document.getElementById('quoteStatusDist').innerHTML = distHtml;

  renderTrend();
}

function renderTrend() {
  const yearSel = document.getElementById('trendYear');
  if (yearSel.options.length === 0) {
    const curYear = new Date().getFullYear();
    for (let y = curYear - 2; y <= curYear; y++) {
      yearSel.innerHTML += `<option value="${y}" ${y === curYear ? 'selected' : ''}>${y}</option>`;
    }
  }
  const year = Number(yearSel.value);
  const monthData = [];
  let maxVal = 0;

  for (let m = 1; m <= 12; m++) {
    const qTotal = state.quotations
      .filter(q => { const d = new Date(q.date); return d.getFullYear() === year && (d.getMonth()+1) === m; })
      .reduce((s, q) => s + q.total, 0);
    const pTotal = state.purchaseOrders
      .filter(p => { const d = new Date(p.date); return d.getFullYear() === year && (d.getMonth()+1) === m; })
      .reduce((s, p) => s + p.total, 0);
    monthData.push({ m, qTotal, pTotal });
    if (qTotal > maxVal) maxVal = qTotal;
    if (pTotal > maxVal) maxVal = pTotal;
  }

  const chartEl = document.getElementById('trendChart');
  chartEl.innerHTML = monthData.map(d => {
    const qH = maxVal > 0 ? Math.max(2, (d.qTotal / maxVal) * 90) : 2;
    const qK = d.qTotal >= 1000 ? Math.round(d.qTotal / 1000) + 'k' : d.qTotal;
    return `<div class="trend-bar-wrap">
      <div class="trend-value">${qK}</div>
      <div style="flex:1;display:flex;align-items:flex-end;width:100%">
        <div class="trend-bar" style="height:${qH}%"></div>
      </div>
      <div class="trend-label">${d.m}月</div>
    </div>`;
  }).join('');

  const yearQTotal = monthData.reduce((s, d) => s + d.qTotal, 0);
  const yearPTotal = monthData.reduce((s, d) => s + d.pTotal, 0);
  document.getElementById('trendSummary').innerHTML = `
    <span>報價 <strong>NTD ${numberFormat(yearQTotal)}</strong></span>
    <span>採購 <strong>NTD ${numberFormat(yearPTotal)}</strong></span>
  `;
}

// ==================== 設定頁 ====================
function renderSettings() {
  document.getElementById('settingApiUrl').value = state.settings.apiUrl || '';
  document.getElementById('settingRecorder').value = state.settings.recorder || '';
  document.getElementById('settingCompanyName').value = state.settings.companyInfo?.name || '堅心 Outrun Nutrition';
  document.getElementById('settingLegalName').value = state.settings.companyInfo?.legalName || '';
  document.getElementById('settingNameEn').value = state.settings.companyInfo?.nameEn || '';
  document.getElementById('settingTaxId').value = state.settings.companyInfo?.taxId || '';
  document.getElementById('settingCompanyPhone').value = state.settings.companyInfo?.phone || '';
  document.getElementById('settingCompanyEmail').value = state.settings.companyInfo?.email || '';
  document.getElementById('settingCompanyAddr').value = state.settings.companyInfo?.address || '';
  document.getElementById('settingSalesName').value = state.settings.salesRep?.name || '';
  document.getElementById('settingSalesPhone').value = state.settings.salesRep?.phone || '';
  document.getElementById('settingSalesEmail').value = state.settings.salesRep?.email || '';
  document.getElementById('settingSalesLine').value = state.settings.salesRep?.line || '';
  document.getElementById('settingBankName').value = state.settings.bankInfo?.bankName || '';
  document.getElementById('settingBankCode').value = state.settings.bankInfo?.bankCode || '';
  document.getElementById('settingBankBranch').value = state.settings.bankInfo?.branch || '';
  document.getElementById('settingBankHolder').value = state.settings.bankInfo?.holder || '';
  document.getElementById('settingBankAccount').value = state.settings.bankInfo?.account || '';
  document.getElementById('settingPdfTerms').value = state.settings.pdfTerms || '';
  // 圖片預覽
  renderImagePreview('logo', state.settings.logoBase64);
  renderImagePreview('stamp', state.settings.stampBase64);
  renderProductList();
}

function saveSettings() {
  state.settings.apiUrl = document.getElementById('settingApiUrl').value.trim();
  state.settings.recorder = document.getElementById('settingRecorder').value.trim();
  state.settings.companyInfo = {
    name: document.getElementById('settingCompanyName').value.trim(),
    legalName: document.getElementById('settingLegalName').value.trim(),
    nameEn: document.getElementById('settingNameEn').value.trim(),
    taxId: document.getElementById('settingTaxId').value.trim(),
    phone: document.getElementById('settingCompanyPhone').value.trim(),
    email: document.getElementById('settingCompanyEmail').value.trim(),
    address: document.getElementById('settingCompanyAddr').value.trim(),
  };
  state.settings.salesRep = {
    name: document.getElementById('settingSalesName').value.trim(),
    phone: document.getElementById('settingSalesPhone').value.trim(),
    email: document.getElementById('settingSalesEmail').value.trim(),
    line: document.getElementById('settingSalesLine').value.trim(),
  };
  state.settings.bankInfo = {
    bankName: document.getElementById('settingBankName').value.trim(),
    bankCode: document.getElementById('settingBankCode').value.trim(),
    branch: document.getElementById('settingBankBranch').value.trim(),
    holder: document.getElementById('settingBankHolder').value.trim(),
    account: document.getElementById('settingBankAccount').value.trim(),
  };
  state.settings.pdfTerms = document.getElementById('settingPdfTerms').value.trim();
  saveState();
  updateSyncStatus();
  showToast('設定已儲存', 'success');
}

function renderProductList() {
  const container = document.getElementById('productList');
  document.getElementById('productCountBadge').textContent = state.products.length;
  if (state.products.length === 0) {
    container.innerHTML = '<div style="text-align:center;color:var(--text-dim);padding:16px">尚無產品</div>';
    return;
  }
  container.innerHTML = state.products.map((p, i) => `
    <div class="product-list-item">
      <div class="product-info">
        <div class="product-name">${p.name}</div>
        <div class="product-spec">${p.spec}｜${p.unit}</div>
      </div>
      <span class="product-price">${p.price > 0 ? 'NTD ' + numberFormat(p.price) : '依報價'}</span>
      <button class="btn btn-danger btn-sm" onclick="removeProduct(${i})" style="padding:4px 8px;font-size:11px">✕</button>
    </div>
  `).join('');
}

function addCustomProduct() {
  const name = document.getElementById('newProdName').value.trim();
  const spec = document.getElementById('newProdSpec').value.trim();
  const price = Number(document.getElementById('newProdPrice').value) || 0;
  const unit = document.getElementById('newProdUnit').value.trim() || '個';
  if (!name) { showToast('請輸入品名', 'error'); return; }
  state.products.push({ name, spec, price, unit });
  saveState();
  renderProductList();
  document.getElementById('newProdName').value = '';
  document.getElementById('newProdSpec').value = '';
  document.getElementById('newProdPrice').value = '';
  document.getElementById('newProdUnit').value = '';
  showToast('已新增產品', 'success');
}

function removeProduct(idx) {
  if (!confirm('確定刪除「' + state.products[idx].name + '」？')) return;
  state.products.splice(idx, 1);
  saveState();
  renderProductList();
}

// ==================== 雲端同步骨架 ====================
function updateSyncStatus() {
  const dot = document.getElementById('syncDot');
  const label = document.getElementById('syncLabel');
  if (state.settings.apiUrl) {
    dot.className = 'sync-dot';
    label.textContent = '已連線';
  } else {
    dot.className = 'sync-dot offline';
    label.textContent = '本機';
  }
}

async function callApi(method, data) {
  const url = state.settings.apiUrl;
  if (!url) throw new Error('未設定 API URL');

  if (method === 'GET') {
    const params = new URLSearchParams(data).toString();
    const res = await fetch(url + '?' + params);
    return await res.json();
  } else {
    const res = await fetch(url, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data),
    });
    return await res.json();
  }
}

async function syncToCloud() {
  if (!state.settings.apiUrl) {
    showToast('請先在設定頁填入 API URL', 'error');
    return;
  }

  if (state.pendingSync.length === 0) {
    showToast('沒有待同步的資料', 'info');
    return;
  }

  showToast('正在同步...', 'info');
  let success = 0;
  let fail = 0;

  for (const item of state.pendingSync) {
    try {
      await callApi('POST', { action: item.type, ...item.data });
      success++;
    } catch (e) {
      fail++;
    }
  }

  if (fail === 0) {
    state.pendingSync = [];
    saveState();
    showToast(`同步完成！共 ${success} 筆`, 'success');
  } else {
    showToast(`同步部分完成：${success} 成功 / ${fail} 失敗`, 'warning');
  }
}

function clearLocalData() {
  if (!confirm('確定要清除所有本地資料嗎？\n（報價單、採購單、產品目錄都會被清除）')) return;
  if (!confirm('此操作無法復原，確定要繼續嗎？')) return;
  Object.values(STORAGE_KEYS).forEach(k => localStorage.removeItem(k));
  state.quotations = [];
  state.purchaseOrders = [];
  state.products = [...DEFAULT_PRODUCTS];
  state.pendingSync = [];
  saveState();
  renderSettings();
  showToast('本地資料已清除', 'info');
}

// ==================== 圖片上傳處理 ====================
function handleImageUpload(type, input) {
  const file = input.files[0];
  if (!file) return;
  if (file.size > 2 * 1024 * 1024) {
    showToast('圖片大小不得超過 2MB', 'error');
    input.value = '';
    return;
  }
  const reader = new FileReader();
  reader.onload = function(e) {
    const base64 = e.target.result;
    if (type === 'logo') {
      state.settings.logoBase64 = base64;
    } else if (type === 'stamp') {
      state.settings.stampBase64 = base64;
    }
    saveState();
    renderImagePreview(type, base64);
    showToast((type === 'logo' ? 'Logo' : '發票章') + ' 已上傳', 'success');
  };
  reader.readAsDataURL(file);
}

function clearImage(type) {
  if (type === 'logo') {
    state.settings.logoBase64 = '';
  } else if (type === 'stamp') {
    state.settings.stampBase64 = '';
  }
  saveState();
  renderImagePreview(type, '');
  showToast((type === 'logo' ? 'Logo' : '發票章') + ' 已清除', 'info');
}

function renderImagePreview(type, base64) {
  const container = document.getElementById(type + 'Preview');
  if (!container) return;
  if (base64) {
    container.innerHTML = '<img src="' + base64 + '" style="max-height:60px;max-width:200px;border-radius:4px;border:1px solid rgba(255,255,255,0.1)">';
  } else {
    container.innerHTML = '<div style="color:var(--text-dim);font-size:12px">尚未上傳</div>';
  }
}

// ==================== PDF 產生（html2canvas 方案）====================
function escHtml(s) { return String(s || '').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }

function buildQuoteHTML(q) {
  const co = state.settings.companyInfo;
  const sr = state.settings.salesRep || {};
  const bank = state.settings.bankInfo || {};
  const terms = state.settings.pdfTerms || '';
  const logoSrc = state.settings.logoBase64 || '';
  const stampSrc = state.settings.stampBase64 || '';
  const accent = '#145DDD';
  const afterDiscount = q.subtotal - (q.discountAmount || 0);
  const taxLabelMap = { excluded: '營業稅（5%）', included: '營業稅（內含 5%）', exempt: '營業稅（免稅）' };
  const untaxed = q.taxType === 'included' ? Math.round(afterDiscount / 1.05) : afterDiscount;

  let itemsHTML = q.items.map((item, i) => `
    <tr style="border-bottom:1px solid #e5e5e5">
      <td style="text-align:center;padding:8px 4px">${i + 1}</td>
      <td style="padding:8px 6px">${escHtml(item.productName)}${item.spec ? '<br><span style="color:#888;font-size:11px">' + escHtml(item.spec) + '</span>' : ''}</td>
      <td style="text-align:center;padding:8px 4px">${item.qty}</td>
      <td style="text-align:center;padding:8px 4px">${escHtml(item.unit || '個')}</td>
      <td style="text-align:right;padding:8px 6px">NT$ ${numberFormat(item.unitPrice)}</td>
      <td style="text-align:right;padding:8px 6px">NT$ ${numberFormat(item.subtotal)}</td>
    </tr>
  `).join('');

  const allNotes = [q.notes, terms].filter(Boolean).join('\n');

  return `
  <div style="font-family:'Noto Sans TC','Microsoft JhengHei','PingFang TC',sans-serif;color:#333;width:720px;padding:40px 45px;background:#fff;line-height:1.5">
    <!-- 標頭 -->
    <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px">
      <div>
        ${logoSrc ? '<img src="' + logoSrc + '" style="display:block;width:280px;margin-bottom:8px" crossorigin="anonymous">' : '<div style="font-size:22px;font-weight:700;color:' + accent + ';margin-bottom:4px">' + escHtml(co.name || '堅心 Outrun Nutrition') + '</div>'}
        ${co.legalName ? '<div style="font-size:11px;color:#666">' + escHtml(co.legalName) + (co.nameEn ? ' / ' + escHtml(co.nameEn) : '') + '</div>' : ''}
        ${co.taxId ? '<div style="font-size:11px;color:#666">統編：' + escHtml(co.taxId) + '</div>' : ''}
        ${co.address ? '<div style="font-size:11px;color:#666">地址：' + escHtml(co.address) + '</div>' : ''}
        ${co.phone ? '<div style="font-size:11px;color:#666">電話：' + escHtml(co.phone) + '</div>' : ''}
      </div>
      <div style="text-align:right">
        <div style="font-size:28px;font-weight:700;color:${accent};letter-spacing:2px">QUOTATION</div>
        <div style="font-size:16px;color:#666;margin-bottom:6px">報價單</div>
        <div style="font-size:11px;color:#555">報價單號：${escHtml(q.id)}</div>
        <div style="font-size:11px;color:#555">開立日期：${escHtml(q.date)}</div>
        <div style="font-size:11px;color:#555">有效期限：${escHtml(q.validUntil)}</div>
      </div>
    </div>
    <div style="border-top:3px solid ${accent};margin-bottom:16px"></div>

    <!-- 客戶 + 業務 -->
    <div style="display:flex;gap:16px;margin-bottom:16px">
      <div style="flex:1;border:1px solid #ddd;border-radius:4px;padding:12px">
        <div style="font-size:11px;font-weight:600;color:${accent};margin-bottom:6px">客戶資訊 BILL TO</div>
        <div style="font-size:14px;font-weight:600;color:#333;margin-bottom:4px">${escHtml(q.customer.name)}</div>
        ${q.customer.contact ? '<div style="font-size:11px;color:#666">聯繫人：' + escHtml(q.customer.contact) + '</div>' : ''}
        ${q.customer.address ? '<div style="font-size:11px;color:#666">地址：' + escHtml(q.customer.address) + '</div>' : ''}
        ${q.customer.phone ? '<div style="font-size:11px;color:#666">電話：' + escHtml(q.customer.phone) + '</div>' : ''}
        ${q.customer.email ? '<div style="font-size:11px;color:#666">Email：' + escHtml(q.customer.email) + '</div>' : ''}
      </div>
      <div style="flex:1;border:1px solid #ddd;border-radius:4px;padding:12px">
        <div style="font-size:11px;font-weight:600;color:${accent};margin-bottom:6px">業務代表 SALES REP</div>
        <div style="font-size:14px;font-weight:600;color:#333;margin-bottom:4px">${escHtml(sr.name || state.settings.recorder || '')}</div>
        ${sr.phone ? '<div style="font-size:11px;color:#666">電話：' + escHtml(sr.phone) + '</div>' : ''}
        ${sr.email ? '<div style="font-size:11px;color:#666">Email：' + escHtml(sr.email) + '</div>' : ''}
        ${sr.line ? '<div style="font-size:11px;color:#666">LINE：' + escHtml(sr.line) + '</div>' : ''}
      </div>
    </div>

    <!-- 明細表格 -->
    <table style="width:100%;border-collapse:collapse;margin-bottom:16px;font-size:12px">
      <thead>
        <tr style="background:${accent};color:#fff">
          <th style="padding:8px 6px;text-align:center;width:36px">#</th>
          <th style="padding:8px 6px;text-align:left">品項 Description</th>
          <th style="padding:8px 6px;text-align:center;width:55px">數量</th>
          <th style="padding:8px 6px;text-align:center;width:50px">單位</th>
          <th style="padding:8px 6px;text-align:right;width:90px">單價</th>
          <th style="padding:8px 6px;text-align:right;width:100px">小計</th>
        </tr>
      </thead>
      <tbody>
        ${itemsHTML}
      </tbody>
    </table>

    <!-- 金額匯總 -->
    <div style="display:flex;justify-content:flex-end;margin-bottom:16px">
      <div style="width:280px">
        <div style="display:flex;justify-content:space-between;padding:4px 0;font-size:12px;color:#666">
          <span>銷售合計（未稅）</span><span>NT$ ${numberFormat(untaxed)}</span>
        </div>
        ${q.discountAmount ? '<div style="display:flex;justify-content:space-between;padding:4px 0;font-size:12px;color:#666"><span>折扣</span><span>-NT$ ' + numberFormat(q.discountAmount) + '</span></div>' : ''}
        <div style="display:flex;justify-content:space-between;padding:4px 0;font-size:12px;color:#666">
          <span>${taxLabelMap[q.taxType] || '營業稅（5%）'}</span><span>NT$ ${numberFormat(q.taxAmount)}</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:4px 0;font-size:12px;color:#555">
          <span>商品總額（含稅）</span><span>NT$ ${numberFormat(q.total)}</span>
        </div>
        <div style="border-top:2px solid ${accent};margin:4px 0"></div>
        <div style="display:flex;justify-content:space-between;padding:6px 0;font-size:16px;font-weight:700;color:${accent}">
          <span>總計 Total</span><span>NT$ ${numberFormat(q.total)}</span>
        </div>
      </div>
    </div>

    <!-- 匯款資訊 -->
    ${(bank.bankName || bank.account) ? `
    <div style="border:1px solid #ddd;border-radius:4px;padding:10px 12px;margin-bottom:12px">
      <div style="font-size:11px;font-weight:600;color:${accent};margin-bottom:4px">匯款資訊 PAYMENT</div>
      ${bank.bankCode && bank.bankName ? '<div style="font-size:11px;color:#555">銀行代碼：' + escHtml(bank.bankCode) + '（' + escHtml(bank.bankName) + '）</div>' : ''}
      ${bank.branch ? '<div style="font-size:11px;color:#555">分行：' + escHtml(bank.branch) + '</div>' : ''}
      ${bank.account ? '<div style="font-size:11px;color:#555">帳號：' + escHtml(bank.account) + '</div>' : ''}
      ${bank.holder ? '<div style="font-size:11px;color:#555">戶名：' + escHtml(bank.holder) + '</div>' : ''}
    </div>` : ''}

    <!-- 備註條款 -->
    ${allNotes ? `
    <div style="border:1px solid #ddd;border-radius:4px;padding:10px 12px;margin-bottom:20px">
      <div style="font-size:11px;font-weight:600;color:${accent};margin-bottom:4px">備註條款 TERMS</div>
      <div style="font-size:10px;color:#666;white-space:pre-line">${escHtml(allNotes)}</div>
    </div>` : ''}

    <!-- 簽署區 -->
    <div style="display:flex;gap:40px;margin-top:30px">
      <div style="flex:1">
        <div style="font-size:10px;color:#888;margin-bottom:4px">客戶簽署 Accepted By</div>
        <div style="height:180px"></div>
        <div style="border-top:1px solid #ccc;padding-top:4px;font-size:9px;color:#aaa">公司名稱 / 日期</div>
      </div>
      <div style="flex:1;text-align:center">
        <div style="font-size:10px;color:#888;margin-bottom:4px">${escHtml(co.legalName || co.name || '')} Authorized By</div>
        <div style="height:180px;position:relative">
          ${stampSrc ? '<img src="' + stampSrc + '" style="position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:180px;height:180px" crossorigin="anonymous">' : ''}
        </div>
        <div style="border-top:1px solid #ccc;padding-top:4px;font-size:9px;color:#aaa">授權簽章 / 日期</div>
      </div>
    </div>

    <!-- 頁腳 -->
    <div style="text-align:center;margin-top:20px;font-size:9px;color:#bbb">
      ${escHtml([co.name, co.phone, co.email].filter(Boolean).join(' | '))}
    </div>
  </div>`;
}

function buildPOHTML(po) {
  const co = state.settings.companyInfo;
  const logoSrc = state.settings.logoBase64 || '';
  const stampSrc = state.settings.stampBase64 || '';
  const accent = '#145DDD';
  const poAfterTax = po.taxType === 'included' ? Math.round(po.subtotal / 1.05) : po.subtotal;
  const taxLabelMap = { excluded: '營業稅（5%）', included: '營業稅（內含 5%）', exempt: '營業稅（免稅）' };

  let itemsHTML = po.items.map((item, i) => `
    <tr style="border-bottom:1px solid #e5e5e5">
      <td style="text-align:center;padding:8px 4px">${i + 1}</td>
      <td style="padding:8px 6px">${escHtml(item.itemName)}${item.spec ? '<br><span style="color:#888;font-size:11px">' + escHtml(item.spec) + '</span>' : ''}</td>
      <td style="text-align:center;padding:8px 4px">${item.qty}</td>
      <td style="text-align:center;padding:8px 4px">${escHtml(item.unit || '個')}</td>
      <td style="text-align:right;padding:8px 6px">NT$ ${numberFormat(item.unitPrice)}</td>
      <td style="text-align:right;padding:8px 6px">NT$ ${numberFormat(item.subtotal)}</td>
    </tr>
  `).join('');

  return `
  <div style="font-family:'Noto Sans TC','Microsoft JhengHei','PingFang TC',sans-serif;color:#333;width:720px;padding:40px 45px;background:#fff;line-height:1.5">
    <!-- 標頭 -->
    <div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px">
      <div>
        ${logoSrc ? '<img src="' + logoSrc + '" style="display:block;width:280px;margin-bottom:8px" crossorigin="anonymous">' : '<div style="font-size:22px;font-weight:700;color:' + accent + ';margin-bottom:4px">' + escHtml(co.name || '堅心 Outrun Nutrition') + '</div>'}
        ${co.legalName ? '<div style="font-size:11px;color:#666">' + escHtml(co.legalName) + (co.nameEn ? ' / ' + escHtml(co.nameEn) : '') + '</div>' : ''}
        ${co.taxId ? '<div style="font-size:11px;color:#666">統編：' + escHtml(co.taxId) + '</div>' : ''}
        ${co.address ? '<div style="font-size:11px;color:#666">地址：' + escHtml(co.address) + '</div>' : ''}
      </div>
      <div style="text-align:right">
        <div style="font-size:26px;font-weight:700;color:${accent};letter-spacing:1px">PURCHASE ORDER</div>
        <div style="font-size:16px;color:#666;margin-bottom:6px">採購單</div>
        <div style="font-size:11px;color:#555">採購單號：${escHtml(po.id)}</div>
        <div style="font-size:11px;color:#555">開立日期：${escHtml(po.date)}</div>
        ${po.expectedDelivery ? '<div style="font-size:11px;color:#555">預期交貨：' + escHtml(po.expectedDelivery) + '</div>' : ''}
      </div>
    </div>
    <div style="border-top:3px solid ${accent};margin-bottom:16px"></div>

    <!-- 供應商 + 付款條件 -->
    <div style="display:flex;gap:16px;margin-bottom:16px">
      <div style="flex:1;border:1px solid #ddd;border-radius:4px;padding:12px">
        <div style="font-size:11px;font-weight:600;color:${accent};margin-bottom:6px">供應商 VENDOR</div>
        <div style="font-size:14px;font-weight:600;color:#333;margin-bottom:4px">${escHtml(po.vendor.name)}</div>
        ${po.vendor.contact ? '<div style="font-size:11px;color:#666">聯繫人：' + escHtml(po.vendor.contact) + '</div>' : ''}
        ${po.vendor.phone ? '<div style="font-size:11px;color:#666">電話：' + escHtml(po.vendor.phone) + '</div>' : ''}
        ${po.vendor.email ? '<div style="font-size:11px;color:#666">Email：' + escHtml(po.vendor.email) + '</div>' : ''}
      </div>
      <div style="flex:1;border:1px solid #ddd;border-radius:4px;padding:12px">
        <div style="font-size:11px;font-weight:600;color:${accent};margin-bottom:6px">付款條件 TERMS</div>
        <div style="font-size:13px;font-weight:500;color:#333">${escHtml(po.paymentTerms || '月結30天')}</div>
        ${po.relatedQuotationId ? '<div style="font-size:11px;color:#666;margin-top:6px">關聯報價單：' + escHtml(po.relatedQuotationId) + '</div>' : ''}
      </div>
    </div>

    <!-- 明細表格 -->
    <table style="width:100%;border-collapse:collapse;margin-bottom:16px;font-size:12px">
      <thead>
        <tr style="background:${accent};color:#fff">
          <th style="padding:8px 6px;text-align:center;width:36px">#</th>
          <th style="padding:8px 6px;text-align:left">品項 Description</th>
          <th style="padding:8px 6px;text-align:center;width:55px">數量</th>
          <th style="padding:8px 6px;text-align:center;width:50px">單位</th>
          <th style="padding:8px 6px;text-align:right;width:90px">單價</th>
          <th style="padding:8px 6px;text-align:right;width:100px">小計</th>
        </tr>
      </thead>
      <tbody>
        ${itemsHTML}
      </tbody>
    </table>

    <!-- 金額匯總 -->
    <div style="display:flex;justify-content:flex-end;margin-bottom:16px">
      <div style="width:280px">
        <div style="display:flex;justify-content:space-between;padding:4px 0;font-size:12px;color:#666">
          <span>小計（未稅）</span><span>NT$ ${numberFormat(poAfterTax)}</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:4px 0;font-size:12px;color:#666">
          <span>${taxLabelMap[po.taxType] || '營業稅（5%）'}</span><span>NT$ ${numberFormat(po.taxAmount)}</span>
        </div>
        <div style="display:flex;justify-content:space-between;padding:4px 0;font-size:12px;color:#555">
          <span>合計金額（含稅）</span><span>NT$ ${numberFormat(po.total)}</span>
        </div>
        <div style="border-top:2px solid ${accent};margin:4px 0"></div>
        <div style="display:flex;justify-content:space-between;padding:6px 0;font-size:16px;font-weight:700;color:${accent}">
          <span>總計 Total</span><span>NT$ ${numberFormat(po.total)}</span>
        </div>
      </div>
    </div>

    <!-- 備註 -->
    ${po.notes ? `
    <div style="border:1px solid #ddd;border-radius:4px;padding:10px 12px;margin-bottom:20px">
      <div style="font-size:11px;font-weight:600;color:${accent};margin-bottom:4px">備註 NOTES</div>
      <div style="font-size:10px;color:#666;white-space:pre-line">${escHtml(po.notes)}</div>
    </div>` : ''}

    <!-- 簽署區 -->
    <div style="display:flex;gap:40px;margin-top:30px">
      <div style="flex:1">
        <div style="font-size:10px;color:#888;margin-bottom:4px">供應商確認 Vendor Confirmation</div>
        <div style="height:180px"></div>
        <div style="border-top:1px solid #ccc;padding-top:4px;font-size:9px;color:#aaa">公司名稱 / 日期</div>
      </div>
      <div style="flex:1;text-align:center">
        <div style="font-size:10px;color:#888;margin-bottom:4px">${escHtml(co.legalName || co.name || '')} 核准</div>
        <div style="height:180px;position:relative">
          ${stampSrc ? '<img src="' + stampSrc + '" style="position:absolute;bottom:0;left:50%;transform:translateX(-50%);width:180px;height:180px" crossorigin="anonymous">' : ''}
        </div>
        <div style="border-top:1px solid #ccc;padding-top:4px;font-size:9px;color:#aaa">授權簽章 / 日期</div>
      </div>
    </div>

    <!-- 頁腳 -->
    <div style="text-align:center;margin-top:20px;font-size:9px;color:#bbb">
      ${escHtml([co.name, co.phone, co.email].filter(Boolean).join(' | '))}
    </div>
  </div>`;
}

async function htmlToPDF(htmlContent, filename) {
  showToast('正在產生 PDF...', 'info');
  // 建立隱藏的渲染容器
  const container = document.createElement('div');
  container.style.cssText = 'position:fixed;left:-9999px;top:0;z-index:-1;';
  container.innerHTML = htmlContent;
  document.body.appendChild(container);

  try {
    // 等待字體載入
    if (document.fonts && document.fonts.ready) await document.fonts.ready;
    // 短暫延遲確保渲染完成
    await new Promise(r => setTimeout(r, 300));

    const el = container.firstElementChild;
    const canvas = await html2canvas(el, {
      scale: 2.5,
      useCORS: true,
      backgroundColor: '#ffffff',
      logging: false,
    });

    const imgData = canvas.toDataURL('image/jpeg', 0.92);
    const { jsPDF } = window.jspdf;

    // A4 比例：210 x 297 mm
    const pdfW = 210;
    const pdfH = 297;
    const imgW = canvas.width;
    const imgH = canvas.height;
    const ratio = pdfW / imgW;
    const scaledH = imgH * ratio;

    // 如果內容超過一頁，按頁分割
    if (scaledH <= pdfH) {
      const doc = new jsPDF({ unit: 'mm', format: 'a4' });
      doc.addImage(imgData, 'JPEG', 0, 0, pdfW, scaledH);
      doc.save(filename);
    } else {
      const doc = new jsPDF({ unit: 'mm', format: [pdfW, scaledH] });
      doc.addImage(imgData, 'JPEG', 0, 0, pdfW, scaledH);
      doc.save(filename);
    }

    showToast('PDF 已下載：' + filename, 'success');
  } catch (e) {
    console.error('PDF 產生失敗:', e);
    showToast('PDF 產生失敗：' + e.message, 'error');
  } finally {
    document.body.removeChild(container);
  }
}

async function generateQuotePDF(q) {
  const html = buildQuoteHTML(q);
  await htmlToPDF(html, q.id + '.pdf');
}

async function generatePOPDF(po) {
  const html = buildPOHTML(po);
  await htmlToPDF(html, po.id + '.pdf');
}

// ==================== PWA ====================
(function initPWA() {
  const manifest = {
    name: '堅心報價採購 — Outrun Nutrition',
    short_name: '堅心報價採購',
    description: 'Outrun Nutrition 報價單與採購單管理系統',
    start_url: location.href.split('?')[0],
    display: 'standalone',
    background_color: '#2F2F2F',
    theme_color: '#2F2F2F',
    icons: [{
      src: 'data:image/svg+xml,' + encodeURIComponent('<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 192 192"><rect width="192" height="192" rx="32" fill="#2F2F2F"/><text x="96" y="130" text-anchor="middle" font-size="110">📋</text></svg>'),
      sizes: '192x192', type: 'image/svg+xml',
    }],
  };
  const blob = new Blob([JSON.stringify(manifest)], { type: 'application/json' });
  const link = document.createElement('link');
  link.rel = 'manifest';
  link.href = URL.createObjectURL(blob);
  document.head.appendChild(link);

  let deferredPrompt = null;
  window.addEventListener('beforeinstallprompt', (e) => {
    e.preventDefault();
    deferredPrompt = e;
    const banner = document.createElement('div');
    banner.id = 'pwaInstallBanner';
    banner.style.cssText = 'position:fixed;bottom:16px;left:12px;right:12px;background:var(--dark-gray);border:1px solid var(--orange);border-radius:12px;padding:14px 16px;display:flex;align-items:center;gap:12px;z-index:9999;box-shadow:0 4px 20px rgba(0,0,0,0.5)';
    banner.innerHTML = `<div style="font-size:28px">📲</div><div style="flex:1"><div style="font-weight:600;font-size:14px">加到主畫面</div><div style="font-size:11px;color:var(--text-secondary)">安裝堅心報價採購 App</div></div>
    <button onclick="deferredPrompt.prompt();deferredPrompt=null;this.parentElement.remove()" style="background:var(--orange);color:#fff;border:none;border-radius:6px;padding:8px 16px;font-size:13px;font-weight:600;cursor:pointer">安裝</button>
    <button onclick="this.parentElement.remove()" style="background:none;border:none;color:var(--text-dim);cursor:pointer;font-size:18px">✕</button>`;
    document.body.appendChild(banner);
  });
})();

// ==================== 初始化 ====================
function initDateFields() {
  const today = todayStr();
  document.getElementById('quoteDate').value = today;
  document.getElementById('quoteValidUntil').value = addDays(today, 30);
  document.getElementById('poDate').value = today;
}

document.addEventListener('DOMContentLoaded', function() {
  loadState();
  initDateFields();
  updateSyncStatus();

  const now = new Date();
  listYear = statsYear = now.getFullYear();
  listMonth = statsMonth = now.getMonth() + 1;

  // 首次使用名稱提示
  if (!state.settings.recorder) {
    setTimeout(() => {
      const name = prompt('歡迎使用堅心報價/採購系統！\n請輸入你的名字（用於記錄建立人）：');
      if (name && name.trim()) {
        state.settings.recorder = name.trim();
        saveState();
        showToast('你好，' + name.trim() + '！', 'success');
      }
    }, 500);
  }

  addQuoteLineItem();

  // Logo 和發票章已在 loadState() 中自動填充內建預設值
});
</script>
</body>
</html>
